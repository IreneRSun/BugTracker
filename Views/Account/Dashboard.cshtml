@model BugTracker.Models.ViewDataModels.DashboardViewModel

@if (Model.IsCurrentUser)
{
    <div class="row my-1">

        <!-- project creation button -->
        <div class="col-auto">
            <button type="button" class="btn btn-primary bg-grad-standard-blue text-white" data-bs-toggle="modal" data-bs-target="#create-project-dialog">
                Create Project
            </button>
        </div>

        <!-- project search bar -->
        <div class="col-auto">
            <form id="project-search-form" method="post" asp-controller="AccountActions" asp-action="SelectProject">
                <select name="project-search" class="project-search select2 half-screen-width text-black" onchange="submitForm('project-search-form')"></select>
            </form>
        </div>

    </div>
}

<!-- welcome message -->
<div class="row my-5">

    <div class="col-auto">
        <img src=@Model.User.Avatar class="avatar-size-150 rounded-circle outline-grey" />
    </div>

    <div class="col-auto mt-5">
        @if (Model.IsCurrentUser)
        {
            <h1 class="display-1 text-gradient tg-cool-blue font-digital fw-500 d-inline">
                Welcome @Model.User.Name
            </h1>
        } else
        {
            <h1 class="display-1 text-gradient tg-cool-blue font-digital fw-500 d-inline">
                Welcome to @Model.User.Name 's Dashboard
            </h1>
        }
    </div>

</div>

@if (Model.IsCurrentUser)
{
    <!-- project creation modal dialog -->
    <div class="modal fade" id="create-project-dialog" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">

                <form method="post" asp-controller="AccountActions" asp-action="CreateProject">

                    <div class="modal-header">
                        <h5 class="modal-title">Project Creation</h5> 
                    </div>

                    <div class="modal-body">
                        <div class="row">
                            <label for="project-name"><i>Enter a name for the project</i></label>
                        </div>
                        <div class="row">
                            <input type="text" id="project-name" name="project-name" minlength="3" maxlength="50" required
                                   class="ms-2 width-90 rounded-3" placeholder="Enter project name here ..." />
                        </div>
                    </div>

                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary bg-grad-grey text-white" data-bs-dismiss="modal">Cancel</button>
                        <button type="submit" class="btn btn-primary bg-grad-standard-blue text-white">Create Project</button>
                    </div>

                </form>

            </div>
        </div>
    </div>
}

<!-- user's projects -->
<h1 class="mt-40 ms-2 text-gradient tg-dull-gold d-inline"><i class="fa fa-code-fork" aria-hidden="true"></i> User Projects</h1>
@if (Model.UserProjects.Count > 0)
{ 
    <div class="row mt-3">
        @foreach (var project in Model.UserProjects)
        {
            <div class="col-3 m-1">
                <a asp-controller="Account" asp-action="Project" asp-route-projectId=@project.ID class="text-decoration-none">
                    <div class="card hover-push shadow-grey">
                        <img src=@project.Avatar class="card-img" />
                        <h5 class="card-img-overlay rounded-0 mt-40 fill-height-60 bg-grad-dull-gold text-wheat">@project.Name</h5>
                    </div>
                </a>
            </div>
        }
    </div>
}
else
{
    @if (Model.IsCurrentUser)
    {
        <div class="mt-3 text-grey">
            No projects available. Join a project or create one.
        </div>
    } 
    else
    {
        <div class="mt-3 text-grey">
            User is not part of any projects.
        </div>
    }
}