@model BugTracker.Models.ViewDataModels.DashboardViewModel

@if (Model.IsCurrentUser)
{
    <div class="row my-1">

        <!-- project creation button -->
        <div class="col-auto">
            <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#create-project-dialog">Create Project</button>
        </div>

        <!-- project search bar -->
        <div class="col-auto">
            <form id="project-search-form" method="post" asp-controller="AccountActions" asp-action="SelectProject">
                <select name="project-search" class="project-search select2 half-screen-width" onchange="submitForm('project-search-form')"></select>
            </form>
        </div>

    </div>
}

<!-- welcome message -->
<div class="row my-4">

    <div class="col-auto">
        <img src=@Model.User.Avatar class="avatar-size-100 rounded-circle" />
    </div>

    <div class="col-auto mt-5">
        @if (Model.IsCurrentUser)
        {
            <h3>Welcome @Model.User.Name</h3>
        } else
        {
            <h3>Welcome to @Model.User.Name 's Dashboard</h3>
        }
    </div>

</div>

@if (Model.IsCurrentUser)
{
    <!-- project creation modal dialog -->
    <div class="modal fade" id="create-project-dialog" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">

                <form method="post" asp-controller="AccountActions" asp-action="CreateProject">

                    <div class="modal-header">
                        <h5 class="modal-title">Create a Project</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                    </div>

                    <div class="modal-body">
                        <div class="row">
                            <label for="project-name"><i>Enter a name for the project</i></label>
                        </div>
                        <div class="row">
                            <input type="text" id="project-name" name="project-name" placeholder="Project Name" required />
                        </div>
                    </div>

                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                        <button type="submit" class="btn btn-primary">Create Project</button>
                    </div>

                </form>

            </div>
        </div>
    </div>
}

<!-- user's projects -->
<h2 class="mt-3">Projects</h2>
@if (Model.UserProjects.Count > 0)
{ 
    <div class="row mt-3">
        @foreach (var project in Model.UserProjects)
        {
            <div class="col-3 m-1">
                <a asp-controller="Account" asp-action="Project" asp-route-projectId=@project.ID class="text-decoration-none">
                    <div class="card hover-push shadow-grey">
                        <img src=@project.Avatar class="card-img" />
                        <h5 class="card-img-overlay rounded-0 mt-40 fill-height-60 bg-grad-silver text-grey">@project.Name</h5>
                    </div>
                </a>
            </div>
        }
    </div>
}
else
{
    @if (Model.IsCurrentUser)
    {
        <div class="mt-3 text-grey">
            No projects available. Join a project or create one.
        </div>
    } 
    else
    {
        <div class="mt-3 text-grey">
            User is not part of any projects.
        </div>
    }
}